#plot_samples_hist(sample_stats,"GPA_Mean",mean_pop)
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 0.34), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept=0.62), linetype="solid",  color="yellow", size=2)
}
#plot_samples_hist(sample_stats,"GPA_Mean",mean_pop)
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
#geom_vline(aes(xintercept= 0.34), linetype="solid", color="yellow", size=2) +
#geom_vline(aes(xintercept=0.62), linetype="solid",  color="yellow", size=2)
}
#plot_samples_hist(sample_stats,"GPA_Mean",mean_pop)
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col))
#geom_vline(aes(xintercept= 0.34), linetype="solid", color="yellow", size=2) +
#geom_vline(aes(xintercept=0.62), linetype="solid",  color="yellow", size=2)
}
#plot_samples_hist(sample_stats,"GPA_Mean",mean_pop)
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop)
geom_vline(aes(xintercept= 0.4), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept=0.6), linetype="solid",  color="yellow", size=2)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col))
geom_vline(aes(xintercept= 0.4), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept=0.6), linetype="solid",  color="yellow", size=2)
}
#plot_samples_hist(sample_stats,"GPA_Mean",mean_pop)
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 0.4), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept=0.6), linetype="solid",  color="yellow", size=2)
}
#plot_samples_hist(sample_stats,"GPA_Mean",mean_pop)
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop)
plot_samples_hist(sample_stats,"GPA_Mean",mean_pop)
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
#geom_vline(aes(xintercept= 0.4), linetype="solid", color="yellow", size=2) +
#geom_vline(aes(xintercept= 0.6), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col))
#geom_vline(aes(xintercept= 0.4), linetype="solid", color="yellow", size=2) +
#geom_vline(aes(xintercept= 0.6), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
View(sample_stats)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 2.1), linetype="solid", color="yellow", size=2)
#geom_vline(aes(xintercept= 0.6), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 2.5), linetype="solid", color="yellow", size=2)
geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 2.5), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 2.4), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 2.4), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 3), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept= 1), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= 2.4), linetype="solid", color="yellow", size=2) +
geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2) +
#geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
}
n
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2) +
#geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2)
#geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2)
#geom_vline(aes(xintercept= 1.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop,sp_value)
sp_value <- sample_stats[1,]
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop,sp_value)
sp_value <- sample_stats[1,"GPA_Mean"]
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop,sp_value)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
#geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2)
geom_vline(aes(xintercept= 0.25), linetype="solid",  color="yellow", size=2)
geom_vline(aes(xintercept= 0.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop,0)
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop,0)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
#geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2)
geom_vline(aes(xintercept= 0.25), linetype="solid",  color="yellow", size=2)  +
geom_vline(aes(xintercept= 0.7), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop,0)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
#geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2)
geom_vline(aes(xintercept= 0.4), linetype="solid",  color="yellow", size=2)  +
geom_vline(aes(xintercept= 0.6), linetype="solid",  color="yellow", size=2)
}
plot_samples_hist(sample_stats,"Female_Proportion",propFEMALE_pop,0)
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2)
#geom_vline(aes(xintercept= 0.4), linetype="solid",  color="yellow", size=2)  +
#geom_vline(aes(xintercept= 0.6), linetype="solid",  color="yellow", size=2)
}
sp_value <- sample_stats[1,"GPA_Mean"]
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop,sp_value)
sp_value <- sample_stats[10,"GPA_Mean"]
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop,sp_value)
sp_value <- sample_stats[5241,"GPA_Mean"]
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop,sp_value)
library(ggplot2)
get_sample_func <- function(sample_size){
sample_IDs  <- sample(data_pop[,"Student_ID"], replace=FALSE, size=sample_size)
data_sample <- data_pop[which(data_pop[,"Student_ID"] %in% sample_IDs),]
return(data_sample)
}
compute_average <- function(input_data,variable_col,cohort_name){
mean_val    <- mean(input_data[,variable_col])
#print(paste("Average", variable_col,"of", cohort_name, "is:",mean_val))
return(mean_val)
}
compute_proportion <- function(input_data,variable_col,cohort_name){
n_total          <- nrow(input_data)
n_qualified      <- length(which(input_data[,variable_col] == 1))
prop <-  n_qualified/ n_total
#print(paste(variable_col,"Proportion","of",cohort_name ,"is:",prop))
return(prop)
}
###Create population
set.seed(1)
n <- 5000
student_id <- paste0("ID", seq(1,n,1))
gpa        <- sample(c(0,0.5,1,1.5,2,2.5,3,3.5,4), replace = TRUE,size=n)      #Random generate 1000 student GPA
female     <- sample(c(0,1), replace=TRUE, size=n) #Random generate Gender student GPA
male       <- 1- female
###Population data
data_pop <- data.frame(Student_ID = student_id,GPA = gpa,FEMALE =  female, MALE = male)
##Population MEAN and proportion
meanGPA_pop <- compute_average(data_pop,"GPA","Population")
propFEMALE_pop <- compute_proportion(data_pop,"FEMALE","Population")
propMALE_pop   <- compute_proportion(data_pop,"MALE","Population")
##################################################
#Generate 10000 samples with sample size = 100
##################################################
n_samples <- 1000
sample_size <- 20
sample_data_list <- list(NA)
for (i in 1:n_samples){
set.seed(i)
sample_data_list[[i]] <- get_sample_func(sample_size)
}
example_sample_data <-  sample_data_list[[1]]
#############################################################
#Compute average GPA and female proportaion for each sample
#############################################################
sample_stats <- as.data.frame(matrix(NA, nrow = n_samples,ncol = 3))
colnames(sample_stats) <- c("Sample_NAME","GPA_Mean","Female_Proportion")
for (i in 1:n_samples){
curr_sample_data <- sample_data_list[[i]]
sample_stats[i,"Sample_NAME"]       <- paste0("Sample",i)
sample_stats[i,"GPA_Mean"]           <- compute_average(curr_sample_data,"GPA","Sample")
sample_stats[i,"Female_Proportion"] <- compute_proportion(curr_sample_data,"FEMALE","Sample")
}
plot_samples_hist <- function(sample_stats_data,variable_col,population_value,sp_value){
if(variable_col == "GPA_Mean"){
bw <- 0.01
}else{
bw <- 0.01
}
avg_of_sample_value <- mean(sample_stats_data[,variable_col])
ggplot(sample_stats_data, aes_string(x=variable_col)) +
geom_histogram(color="black", fill="white",binwidth = bw) +
geom_vline(aes(xintercept=avg_of_sample_value,color="sample"), linetype="solid", size=2) +
geom_vline(aes(xintercept=population_value, color="popuplation"), linetype="dashed", size=2) +
scale_color_manual(name = "",
values = c(sample = "orangered3", popuplation = "seagreen2"),
labels = c(paste("Mean of","Sample",variable_col),paste("Population",variable_col))) +
labs(x = paste("Sample's",variable_col)) +
geom_vline(aes(xintercept= sp_value), linetype="solid", color="yellow", size=2)
#geom_vline(aes(xintercept= 0.4), linetype="solid",  color="yellow", size=2)  +
#geom_vline(aes(xintercept= 0.6), linetype="solid",  color="yellow", size=2)
}
sp_value <- sample_stats[5241,"GPA_Mean"]
plot_samples_hist(sample_stats,"GPA_Mean",meanGPA_pop,sp_value)
source('~/Desktop/Explain_CI.R', echo=TRUE)
source('~/Desktop/Explain_CI.R', echo=TRUE)
source('~/Desktop/Explain_CI.R', echo=TRUE)
source('~/Desktop/Explain_CI.R', echo=TRUE)
setwd("~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code")
