#3. baseline eGFR
Baseline_EGFR_df <-read.csv(paste0(outdir,"Baseline_EGFR.csv"),stringsAsFactors = F)
#4. kidney Transplant
KidneyTransplant_df <-read.csv(paste0(outdir,"KidneyTransplant.csv"),stringsAsFactors = F)
#5. Scr num in D0-D3
Src_df <-read.csv(paste0(outdir,"Scr_Baseline_Admit_Peak_NUM_ICU_D0D3_df.csv"),stringsAsFactors = F)
#6. KIDGO in D0-D3
KDIGO_df <-read.csv(paste0(outdir,"KDIGO_Admit_MAX_LAST_ICU_D0D3_df.csv"),stringsAsFactors = F)
#7. ICU_LOS
All_time_df <-read.csv(paste0(outdir,"All_Corrected_Timeinfo.csv"),stringsAsFactors = F)
All_time_df$ICU_LOS_Hours <- NA
All_time_df$ICU_LOS_Hours <- as.numeric(difftime(ymd_hms(All_time_df[,"Updated_ICU_DISCHARGE_DATE"]),ymd_hms(All_time_df[,"Updated_ICU_ADMIT_DATE"]),units = "hours"))
#8. died in D0-D3
All_Mortality_df <-read.csv(paste0(outdir,"All_Mortality.csv"),stringsAsFactors = F)
##########################################################################################
#2. Analysis Id for pts has corrected HOSP ADMISSION time and has all demo info
##########################################################################################
inclusion_ID <- Inclusion_df$STUDY_PATIENT_ID
##########################################################################################
#2.Exclusion
##########################################################################################
exclude_pts_func <-function(analysis_IDs,exclusion_IDs){
remove_idx <- which(analysis_IDs %in% exclusion_IDs)
if (length(remove_idx) > 0 ){ #if analysis_IDs has any ID qualifies exclusion
acutal_exclusion_ID <- analysis_IDs[remove_idx] #The IDs in anlaysis Id qualifies exlucsion criteria
updated_analysis_IDs <- analysis_IDs[-remove_idx]
}else{ #remove nothing
acutal_exclusion_ID <-NULL
updated_analysis_IDs <- analysis_IDs
}
return(list(acutal_exclusion_ID,updated_analysis_IDs))
}
#Exclude 1- <18 years old
ExclusionID1 <- Demo_df[which(Demo_df[,"AGE"] < 18),"STUDY_PATIENT_ID"]
res <- exclude_pts_func(inclusion_ID,ExclusionID1)
actual_exclusion_IDs1 <- res[[1]]
updated_inclusion_IDs1 <- res[[2]]
length(actual_exclusion_IDs1) #0
length(updated_inclusion_IDs1) #10502
#Exclude 2- Baseline eGFR <15
ExclusionID2 <- Baseline_EGFR_df[which(Baseline_EGFR_df[,"Baseline_eGFR"] < 15),"STUDY_PATIENT_ID"]
res <- exclude_pts_func(updated_inclusion_IDs1,ExclusionID2)
actual_exclusion_IDs2 <- res[[1]]
updated_inclusion_IDs2 <- res[[2]]
length(actual_exclusion_IDs2) #222
length(updated_inclusion_IDs2) #10280
#Exclude 3- Kidney transplant before or during hospitalization
ExclusionID3 <- KidneyTransplant_df[which(KidneyTransplant_df[,"KidneyTrans_BEFOREorDURING"] == 1),"STUDY_PATIENT_ID"]
res <- exclude_pts_func(updated_inclusion_IDs2,ExclusionID3)
actual_exclusion_IDs3 <- res[[1]]
updated_inclusion_IDs3 <- res[[2]]
length(actual_exclusion_IDs3) #12
length(updated_inclusion_IDs3) #  10268
#Exclude 4- <1 SCr measurement in the first 3 days of ICU admission (D0 to D3)
ExclusionID4 <- Src_df[which(Src_df[,"NUM_SCr_inICU_D0_D3"] < 1),"STUDY_PATIENT_ID"]
res <- exclude_pts_func(updated_inclusion_IDs3,ExclusionID4)
actual_exclusion_IDs4 <- res[[1]]
updated_inclusion_IDs4 <- res[[2]]
length(actual_exclusion_IDs4) #215
length(updated_inclusion_IDs4) #10053
#Exclude 5- No AKI in the first 3 days of ICU admission (D0 to D3)
ExclusionID5 <- KDIGO_df[which(KDIGO_df[,"MAX_KDIGO_ICU_D0toD3"] == 0 |is.na(KDIGO_df[,"MAX_KDIGO_ICU_D0toD3"])==T),"STUDY_PATIENT_ID"]
res <- exclude_pts_func(updated_inclusion_IDs4,ExclusionID5)
actual_exclusion_IDs5 <- res[[1]]
updated_inclusion_IDs5 <- res[[2]]
length(actual_exclusion_IDs5) #7515
length(updated_inclusion_IDs5) # 2540
#Exclude 6- <24 hours of ICU stay
ExclusionID6 <- All_time_df[which(All_time_df[,"ICU_LOS_Hours"] < 24),"STUDY_PATIENT_ID"]
res <- exclude_pts_func(updated_inclusion_IDs5,ExclusionID6)
actual_exclusion_IDs6 <- res[[1]]
updated_inclusion_IDs6 <- res[[2]]
length(actual_exclusion_IDs6) #0
length(updated_inclusion_IDs6) # 2540
#Exclude 7- Died in the first 3 days (D0 to D3) of ICU admission
ExclusionID7 <- All_Mortality_df[which(All_Mortality_df[,"Death_ICU_D0toD3"] == 1),"STUDY_PATIENT_ID"]
res <- exclude_pts_func(updated_inclusion_IDs6,ExclusionID7)
actual_exclusion_IDs7 <- res[[1]]
updated_inclusion_IDs7 <- res[[2]]
length(actual_exclusion_IDs7) # 91
length(updated_inclusion_IDs7) # 2449
#Exclude 8 - ESRD (ESKD) diagnosis before hospitalization
ExclusionID8 <- Final_ESRD_BEFORE_AT_df[which(Final_ESRD_BEFORE_AT_df[,"ESRD_BEFORE_AT"] == 1),"STUDY_PATIENT_ID"]
res <- exclude_pts_func(updated_inclusion_IDs7,ExclusionID8)
actual_exclusion_IDs8 <- res[[1]]
updated_inclusion_IDs8 <- res[[2]]
length(actual_exclusion_IDs8) # 216
length(updated_inclusion_IDs8) #2233
setwd("~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code")
source("TAKI_Ultility.R")
library(lubridate)
change_feature_name_intable <- function(input_tb,name_tochange,updated_name){
var_ind <- which(input_tb[,1] == name_tochange)
if (length(var_ind) > 0 ){
input_tb[var_ind,1] <- updated_name
}
return(input_tb)
}
change_listoffeature_name_intable <- function(input_tb){
input_tb <- change_feature_name_intable(input_tb,"UrineOutput_D0toD3","Urine Output")
input_tb <- change_feature_name_intable(input_tb,"Vasopressor_ICUD0toD3","Vasopressor Exposure")
input_tb <- change_feature_name_intable(input_tb,"FI02_D1_HIGH","FiO2 (High)")
input_tb <- change_feature_name_intable(input_tb,"Platelets_D1_LOW","Platelets (Low)")
input_tb <- change_feature_name_intable(input_tb,"AGE","Age")
input_tb <- change_feature_name_intable(input_tb,"BUN_D0toD3_HIGH","BUN (High)")
input_tb <- change_feature_name_intable(input_tb,"HR_D1_HIGH","Heart Rate (High")
input_tb <- change_feature_name_intable(input_tb,"LAST_KDIGO_ICU_D0toD3","Last KDIGO")
input_tb <- change_feature_name_intable(input_tb,"PH_D1_LOW","pH (Low)")
input_tb <- change_feature_name_intable(input_tb,"Bilirubin_D1_HIGH","Bilirubin (High)")
input_tb <- change_feature_name_intable(input_tb,"MAX_KDIGO_ICU_D0toD3","Maximum KDIGO")
input_tb <- change_feature_name_intable(input_tb, "ECMO_ICUD0toD3","ECMO")
input_tb <- change_feature_name_intable(input_tb, "Hours_inICUD0toD3","Hours in ICU")
input_tb <- change_feature_name_intable(input_tb, "Temperature_D1_LOW","Temperature (Low)")
input_tb <- change_feature_name_intable(input_tb, "Temperature_D1_HIGH","Temperature (High)")
input_tb <- change_feature_name_intable(input_tb, "Hemoglobin_D1_LOW","Hemoglobin (Low)")
input_tb <- change_feature_name_intable(input_tb, "Admit_sCr","ICU admission sCr")
input_tb <- change_feature_name_intable(input_tb, "Sodium_D1_LOW","Sodium (Low)")
return(input_tb)
}
#Data dir
UK_data_dir <- "/Volumes/LJL_ExtPro/Data/AKI_Data/TAKI_Data_Extracted/uky/"
UTSW_data_dir <- "/Volumes/LJL_ExtPro/Data/AKI_Data/TAKI_Data_Extracted/utsw/"
#out dir
out_dir <- "/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/Intermediate_Results/Prediction_results0806/Discrip_Stats/"
####################################################################################
#### 1. Load data
####################################################################################
feature_file <- "Model_Feature_Outcome/All_Feature_NOTimputed.csv"
outcome_file <- "Model_Feature_Outcome/All_outcome.csv"
outcome_colname_list <- c("Death_inHOSP","MAKE_HOSP120_Drop50")
#For UK
UK_data <- Combine_featureAndoutcomes_func(UK_data_dir,feature_file,outcome_file,outcome_colname_list)
#For UTSW
UTSW_data <- Combine_featureAndoutcomes_func(UTSW_data_dir,feature_file,outcome_file,outcome_colname_list)
####################################################################################
#### 7. Final ID time info
####################################################################################
UK_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/TAKI_Data_Extracted/uky/All_Corrected_Timeinfo.csv",stringsAsFactors = F)
UTSW_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/TAKI_Data_Extracted/utsw/All_Corrected_Timeinfo.csv",stringsAsFactors = F)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
#For UTSW
UTSW_Time_data <- UTSW_Time_data[which(UTSW_Time_data$STUDY_PATIENT_ID %in% UTSW_data$STUDY_PATIENT_ID),]
min(UK_Time_data$Updated_ICU_ADMIT_DATE)
max(UK_Time_data$Updated_ICU_ADMIT_DATE)
####################################################################################
#### 7. Final ID raw time info
####################################################################################
UK_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/Taylors_Data/UKY/raw_csv_files/ADMISSION_INDX.csv",stringsAsFactors = F)
UTSW_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/Taylors_Data/UTSW/raw_csv_files/tIndexedIcuAdmission.csv",stringsAsFactors = F)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
min(UK_Time_data$Updated_ICU_ADMIT_DATE)
min(UK_Time_data$Updated_ICU_ADMIT_DATE,na.rm = T)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
min(UK_Time_data$ICU_ADMIT_DATE)
max(UK_Time_data$ICU_DISCHARGE_DATE)
UK_Time_data$ICU_ADMIT_DATE
UK_Time_data$ICU_ADMIT_DATE <- mdy(UK_Time_data$ICU_ADMIT_DATE)
min(UK_Time_data$ICU_ADMIT_DATE)
min(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
min(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
####################################################################################
#### 7. Final ID raw time info
####################################################################################
UK_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/Taylors_Data/UKY/raw_csv_files/ADMISSION_INDX.csv",stringsAsFactors = F)
UK_Time_data$ICU_ADMIT_DATE <- mdy(UK_Time_data$ICU_ADMIT_DATE)
min(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
View(UK_Time_data)
####################################################################################
#### 7. Final ID raw time info
####################################################################################
UK_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/Taylors_Data/UKY/raw_csv_files/ADMISSION_INDX.csv",stringsAsFactors = F)
UK_Time_data$ICU_ADMIT_DATE
UK_Time_data$ICU_ADMIT_DATE <- mdy_hms(UK_Time_data$ICU_ADMIT_DATE)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
min(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
####################################################################################
#### 7. Final ID raw time info
####################################################################################
UK_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/Taylors_Data/UKY/raw_csv_files/ADMISSION_INDX.csv",stringsAsFactors = F)
UK_Time_data$ICU_ADMIT_DATE <- mdy_hm(UK_Time_data$ICU_ADMIT_DATE)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
min(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
max(UK_Time_data$ICU_DISCHARGE_DATE)
UK_Time_data$ICU_DISCHARGE_DATE <- mdy_hm(UK_Time_data$ICU_DISCHARGE_DATE)
max(UK_Time_data$ICU_DISCHARGE_DATE)
####################################################################################
#### 7. Final ID raw time info
####################################################################################
UK_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/Taylors_Data/UKY/raw_csv_files/ADMISSION_INDX.csv",stringsAsFactors = F)
UK_Time_data$ICU_ADMIT_DATE <- mdy_hm(UK_Time_data$ICU_ADMIT_DATE)
UTSW_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/Taylors_Data/UTSW/raw_csv_files/tIndexedIcuAdmission.csv",stringsAsFactors = F)
UTSW_Time_data$ICU_ADMSN_TIME
UTSW_Time_data$ICU_ADMSN_TIME <- ymd_hms(UTSW_Time_data$ICU_ADMSN_TIME)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
min(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
max(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
#For UK
UK_Time_data <- UK_Time_data[which(UK_Time_data$STUDY_PATIENT_ID %in% UK_data$STUDY_PATIENT_ID),]
min(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
max(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
View(UK_Time_data)
View(UK_Time_data)
#For UTSW
UTSW_Time_data <- UTSW_Time_data[which(UTSW_Time_data$STUDY_PATIENT_ID %in% UTSW_data$STUDY_PATIENT_ID),]
UTSW_Time_data <- read.csv("/Volumes/LJL_ExtPro/Data/AKI_Data/Taylors_Data/UTSW/raw_csv_files/tIndexedIcuAdmission.csv",stringsAsFactors = F)
UTSW_Time_data$ICU_ADMSN_TIME <- ymd_hms(UTSW_Time_data$ICU_ADMSN_TIME)
#For UTSW
UTSW_Time_data <- UTSW_Time_data[which(UTSW_Time_data$PATIENT_NUM %in% UTSW_data$STUDY_PATIENT_ID),]
min(UTSW_Time_data$ICU_ADMIT_DATE,na.rm = T)
min(UTSW_Time_data$ICU_ADMSN_TIME,na.rm = T)
max(UTSW_Time_data$ICU_ADMSN_TIME,na.rm = T)
min(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
max(UK_Time_data$ICU_ADMIT_DATE,na.rm = T)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/Process_UTSW/1A_Get_CorrectedTimeInfo_UTSW.R', echo=TRUE)
outdir
source("TAKI_Ultility.R")
library(ggplot2)
process_catogory_data_func <- function(predicted_catogory_df){
#predicted_catogory_df <- UK_mortality_catogory_df
predicted_catogory_df$NUM_PTs_PredINCatogory <- NA
predicted_catogory_df$NUM_PTs_OUTCOME1 <- NA
predicted_catogory_df$PERC_PTs_OUTCOME1 <- NA
for (i in 1:nrow(predicted_catogory_df)){
predicted_catogory_df[i,"NUM_PTs_PredINCatogory"] <- as.numeric(unlist(strsplit(predicted_catogory_df[i,"N_andPerc_PredictedInCategory"],split = " "))[1])
predicted_catogory_df[i,"NUM_PTs_OUTCOME1"] <- as.numeric(unlist(strsplit(predicted_catogory_df[i,"N_andPerc_AcutalLabel1"],split = " "))[1])
if (predicted_catogory_df[i,"NUM_PTs_OUTCOME1"] == 0 | predicted_catogory_df[i,"NUM_PTs_PredINCatogory"] == 0){
predicted_catogory_df[i,"PERC_PTs_OUTCOME1"] <- 0
}else{
predicted_catogory_df[i,"PERC_PTs_OUTCOME1"] <- round((predicted_catogory_df[i,"NUM_PTs_OUTCOME1"]/predicted_catogory_df[i,"NUM_PTs_PredINCatogory"])*100,2)
}
}
#order the levels
predicted_catogory_df$Risk_Category <- factor(predicted_catogory_df$Risk_Category, levels = c("<=10%","(10%, 20%]", "(20%, 30%]", "(30%, 40%]", "(40%, 50%]", "(50%, 60%]", "(60%, 70%]", ">70%"))
return(predicted_catogory_df)
}
plot_risk_categoryAndIncidence_func <- function(plot_data,y_left_max,outcome_name,scale_2nd_y){
p<-ggplot(data=plot_data, aes(x=Risk_Category, y=NUM_PTs_PredINCatogory)) +
geom_bar(aes(fill = Cohort_NAME), position=position_dodge(),stat="identity")+
scale_fill_manual(breaks = c("UK", "UTSW"),values=c("dodgerblue4", "firebrick4")) +
geom_point(aes(x = Risk_Category, y = scale_2nd_y*PERC_PTs_OUTCOME1,shape = Cohort_NAME,color = Cohort_NAME), size = 5) + #scale the second y by 12
scale_shape_manual(breaks = c("UK", "UTSW"), values=c(15, 19)) +
geom_line(aes(x = Risk_Category, y = scale_2nd_y*PERC_PTs_OUTCOME1, group = Cohort_NAME,color = Cohort_NAME), size = 1) + #scale the second y by 12
scale_y_continuous(limits = c(0, y_left_max), breaks = seq(0, y_left_max, by = 200),
sec.axis = sec_axis(~./scale_2nd_y, name = "Outcome Incidence (%)")) +     # adds the secondary Y-axis
scale_color_manual(breaks = c("UK", "UTSW"),values=c("dodgerblue3", "firebrick3")) +
labs(x= "Predicted Risk Category", y = "Number of Patients", title = paste("Predicted Risk vs.",outcome_name,"Incidence"))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
theme(axis.line = element_line(colour = "black", size = 1, linetype = "solid"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
axis.title.x = element_text(margin =ggplot2::margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y.left =  element_text(margin =ggplot2::margin(t = 0, r = 5, b = 0, l = 0)),
axis.title.y.right =  element_text(margin =ggplot2::margin(t = 0, r = 0, b = 0, l = 15)),
legend.position = "top",
legend.title = element_blank(),
legend.text =  element_text(size = 14),
plot.title = element_text(hjust = 0.5, size = 16))
return(p)
}
proj_dir  <- "/Users/lucasliu/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/Intermediate_Results/Prediction_results0806/"
##################################################################################################
######                         Mortality                                            ##############
##################################################################################################
#1. UK
UK_mortality_dir <- paste0(proj_dir,"CV_performance/mortality/UK_SelectedClinicalFeature15Vars_Mortality_Risk_Catogory5_RF.csv")
UK_mortality_catogory_df <- read.csv(UK_mortality_dir,stringsAsFactors = F)
UK_mortality_catogory_df$Cohort_NAME <- "UK"
#2.UTSW
UTSW_mortality_dir <- paste0(proj_dir,"ExternalV_performance/mortality/UTSW_SelectedClinicalFeature15Vars_Mortality_Risk_Catogory5_RF.csv")
UTSW_mortality_catogory_df <- read.csv(UTSW_mortality_dir,stringsAsFactors = F)
UTSW_mortality_catogory_df$Cohort_NAME <- "UTSW"
#3.Cobine two and get plot data
comb_mortality_category_df <- rbind(UK_mortality_catogory_df,UTSW_mortality_catogory_df)
plot_mortality_data <- process_catogory_data_func(comb_mortality_category_df)
#plot
outcome_name <- "Mortality"
max_n_pts_inCategory <- 1250
scale_2nd_y <- 20
p <- plot_risk_categoryAndIncidence_func(plot_mortality_data,max_n_pts_inCategory,outcome_name,scale_2nd_y)
tiff(paste0(proj_dir,"RiskCategory_Plot/",outcome_name,".tiff"), units="in", width=10, height=7, res=300)
print(p)
dev.off()
##################################################################################################
######                         MAKE                                            ##############
##################################################################################################
#1. UK
UK_dir <- paste0(proj_dir,"CV_performance/make120_drop50/UK_SelectedClinicalFeature14Vars_MAKE_Risk_Catogory5_RF.csv")
UK_catogory_df <- read.csv(UK_dir,stringsAsFactors = F)
UK_catogory_df$Cohort_NAME <- "UK"
#2.UTSW
UTSW_dir <- paste0(proj_dir,"ExternalV_performance/make120_drop50/UTSW_SelectedClinicalFeature14Vars_MAKE_Risk_Catogory5_RF.csv")
UTSW_catogory_df <- read.csv(UTSW_dir,stringsAsFactors = F)
UTSW_catogory_df$Cohort_NAME <- "UTSW"
#3.Cobine two and get plot data
comb_category_df <- rbind(UK_catogory_df,UTSW_catogory_df)
plot_data <- process_catogory_data_func(comb_category_df)
#plot
outcome_name <- "MAKE"
max_n_pts_inCategory <- 1250
scale_2nd_y <- 15
p <- plot_risk_categoryAndIncidence_func(plot_data,max_n_pts_inCategory,outcome_name,scale_2nd_y)
p
tiff(paste0(proj_dir,"RiskCategory_Plot/",outcome_name,".tiff"), units="in", width=10, height=7, res=300)
print(p)
dev.off()
##################################################################################################
######                         MAKE For survivors                                           ##############
##################################################################################################
#1. UK
UK_dir <- paste0(proj_dir,"CV_performance/Surviors_make120_drop50/UK_SelectedClinicalFeature14Vars_MAKE_Risk_Catogory5_RF.csv")
UK_catogory_df <- read.csv(UK_dir,stringsAsFactors = F)
UK_catogory_df$Cohort_NAME <- "UK"
#2.UTSW
UTSW_dir <- paste0(proj_dir,"ExternalV_performance/Surviors_make120_drop50/UTSW_SelectedClinicalFeature14Vars_MAKE_Risk_Catogory5_RF.csv")
UTSW_catogory_df <- read.csv(UTSW_dir,stringsAsFactors = F)
UTSW_catogory_df$Cohort_NAME <- "UTSW"
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
tiff(paste0(proj_dir,"RiskCategory_Plot/",outcome_name,".tiff"), units="in", width=14, height=10, res=300)
print(p1)
dev.off()
tiff(paste0(proj_dir,"RiskCategory_Plot/",outcome_name,".tiff"), units="in", width=14, height=10, res=300)
print(p2)
dev.off()
ggarrange(p1, p2,
labels = c("A", "B"),
ncol = 1, nrow = 2)
library(ggpubr)
ggarrange(p1, p2,
labels = c("A", "B"),
ncol = 1, nrow = 2)
p3 <- ggarrange(p1, p2,
labels = c("A", "B"),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","MAKE_and_Mortality",".tiff"), units="in", width=14, height=10, res=300)
print(p3)
dev.off()
library(ggpubr)
p3 <- ggarrange(p1, p2,
labels = c("A", "B"),
font.label = list(size = 20, color = "black", face = "bold", family = NULL)
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","MAKE_and_Mortality",".tiff"), units="in", width=14, height=10, res=300)
print(p3)
dev.off()
library(ggpubr)
p3 <- ggarrange(p1, p2,
labels = c("A", "B"),
font.label = list(size = 20, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","MAKE_and_Mortality",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
library(ggpubr)
p3 <- ggarrange(p1, p2,
labels = c("A", "B"),
font.label = list(size = 50, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","MAKE_and_Mortality",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
#Combine two plot
library(ggpubr)
p3 <- ggarrange(p1, p2,
labels = c("A", "B"),
font.label = list(size = 30, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","MAKE_and_Mortality",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
library(ggpubr)
p3 <- ggarrange(p1, p2,
labels = c("A", "B"),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","MAKE_and_Mortality",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
plot_data
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = -1
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = -1,
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = 1,
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = 0.5,
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.2,-0.5),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.2,-0.3),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.2,-0.1),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.1,-0.1),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.05,-0.1),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.01,-0.1),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.02,-0.1),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.02,-0.08),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.03,-0.08),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
p3 <- ggarrange(p1, p2,
labels = c("A.Hospital Mortality", "B.MAKE"),
hjust = c(-0.04,-0.08),
font.label = list(size = 25, color = "black", face = "bold", family = NULL),
ncol = 1, nrow = 2)
tiff(paste0(proj_dir,"RiskCategory_Plot/","Mortality_And_MAKE",".tiff"), units="in", width=14, height=12, res=300)
print(p3)
dev.off()
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
source('~/Desktop/DrChen_Projects/All_AKI_Projects/Other_Project/TAKI_Project/TAKI_Code/3E_PlotPredRisk_Catogory.R', echo=TRUE)
